import Link from "next/link";

import { useTranslation } from "next-i18next";
import { serverSideTranslations } from "next-i18next/serverSideTranslations";

import { Header } from "../components/Header";
import { Footer } from "../components/Footer";
import { useEffect } from "react";

const LazyReloadPage = () => {
  const { t, i18n } = useTranslation(["lazy-reload-page", "footer"], {
    bindI18n: "languageChanged loaded",
  });
  // bindI18n: loaded is needed because of the reloadResources call
  // if all pages use the reloadResources mechanism, the bindI18n option can also be defined in next-i18next.config.js
  useEffect(() => {
    i18n.reloadResources(i18n.resolvedLanguage, ["lazy-reload-page", "footer"]);
  }, []);

  return (
    <>
      <main>
        <Header heading={t("h1")} title={t("title")} />
        <button
          onClick={() => {
            console.log(t("reload-resource"));
            i18n.reloadResources(i18n.resolvedLanguage, [
              "lazy-reload-page",
              "footer",
            ]);
          }}
          type='button'
        >
          {t("reload-resource")}
        </button>

        <Link href='/'>
          <button type='button'>{t("back-to-home")}</button>
        </Link>
      </main>
      <Footer />
    </>
  );
};

export const getStaticProps = async ({ locale }) => ({
  props: {
    ...(await serverSideTranslations(locale, ["lazy-reload-page", "footer"])),
  },
});

export default LazyReloadPage;
